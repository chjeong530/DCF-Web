<!-- echo '{"access_token": "", "image": "'"$(base64 sample_image.png)"'"}' | curl -X POST -d @- "http://keti.asuscomm.com:32222/function/imagestress" -->
<html>

<head>

<title>:: JavaScript 파일 썸네일 추출 ::</title>

<script type="text/javascript">

    // function uploadImgPreview(){
    //     const toDataURL = url => fetch(url)
    //         .then(response => response.blob())
    //         .then(blob => new Promise((resolve, reject) => {
    //             const reader = new FileReader()
    //             reader.onloadend = () => resolve(reader.result)
    //             reader.onerror = reject
    //             reader.readAsDataURL(blob)
    //         }))

    //     return (
    //         toDataURL('items/sample_image.png')
    //         .then(dataUrl => {
    //             return dataUrl.split(',')[1];
    //         })
    //     )

    //     // return dataUrl.split(',')[1];
    // }

    function uploadImgPreview(){

        // return dataUrl.split(',')[1];
    }
    function run(){
        const toDataURL = url => fetch(url)
            .then(response => response.blob())
            .then(blob => new Promise((resolve, reject) => {
                const reader = new FileReader()
                reader.onloadend = () => resolve(reader.result)
                reader.onerror = reject
                reader.readAsDataURL(blob)
            }))


        const url = 'items/sample_image.png';
        const data = toDataURL(url)
        console.log(data)

        const userAction = async () => {
            const response = await fetch("http://keti.asuscomm.com:32222/function/imagestress", {
                method: 'POST',
                body: data, // string or object
                headers: {
                    'Content-Type': 'application/json'
                }
            });
            const myJson = await response.json(); //extract JSON from the http response
            console.log(myJson)
            // do something with myJson
        }
    }

</script>

</head>

<body>

    <!-- @breif accept 태그는 파일 업로드시 그것을 이미지 파일로 제한한다. -->

    <button onclick="run();">run</button>

    <hr/>

    <img id="thumbnailImg" src="">

    <br/>

    <div id="thumbnailUrl"></div>

</body>

</html> 